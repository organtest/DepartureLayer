/*!build time : 2014-07-18 8:10:32 AM*/
KISSY.add("gallery/DepartureLayer/1.1/store",function(){function a(){return b?b:(b=e.body.appendChild(e.createElement("div")),b.style.display="none",b.addBehavior("#default#userData"),b.load(f),b)}var b,c={},d=window,e=d.document,f="localStorage",g="globalStorage";return c.set=function(){},c.get=function(){},c.remove=function(){},c.clear=function(){},f in d&&d[f]?(b=d[f],c.set=function(a,c){b.setItem(a,c)},c.get=function(a){return b.getItem(a)},c.remove=function(a){b.removeItem(a)},c.clear=function(){b.clear()}):g in d&&d[g]?(b=d[g][d.location.hostname],c.set=function(a,c){b[a]=c},c.get=function(a){return b[a]&&b[a].value},c.remove=function(a){delete b[a]},c.clear=function(){for(var a in b)delete b[a]}):e.documentElement.addBehavior&&(c.set=function(b,c){var d=a();d.setAttribute(b,c),d.save(f)},c.get=function(b){var c=a();return c.getAttribute(b)},c.remove=function(b){var c=a();c.removeAttribute(b),c.save(f)},c.clear=function(){var b=a(),c=b.XMLDocument.documentElement.attributes;b.load(f);for(var d,e=0;d=c[e];e++)b.removeAttribute(d.name);b.save(f)}),c}),KISSY.add("gallery/DepartureLayer/1.1/index",function(a,b,c){function d(b){if("*"===b)return function(){return!0};var c=b.match(g);if(!c)return a.log("Unexpacted version: "+b),h;var d=c[1]||"<=",e=+c[2],f=+c[3];if(d&&e){if("~"===d){var i=e,j=(e/10|0)+10;return function(a){return a&&j>a&&a>=i}}return"="===d&&(d="=="),new Function("version","return null != version && version > 0.1 && (version "+d+" "+e+");")}return(e=c[4])&&f?function(a){return a>=f&&e>=a}:void a.log("Unexpacted version: "+b)}function e(a){return this instanceof e?this.config(a):new e(a)}var f=this.path.split(/\/[^\/]+?$/)[0]+"/",g=/^\s*([<>=~]{0,2})\s*(\d+)\s*$|^\s*(\d+)\s*\-\s*(\d+)\s*$/i,h=a.noop,i=6048e5,j="bk_timestamp";return e.prototype={constructor:e,config:function(c){var e=this,f=e.options=a.mix(e.options||{ua:[],theme:"",expires:i,dialog:{},toptip:{}},c,!0,null,!0),g=f.ua,h="all",j=h;return a.each(g,function(c,f){if(!e.matched){var g=c.browser,h=c.version;e.show=c.show||j;var i=+b[g];if(!i)return void a.log("Warning: `config.ua["+f+"].browser` is invalid. Found `"+b[g]+"` under the `KISSY.UA."+g+"`.");if(!h)return void a.log("Warning: `config.ua["+f+"].version` is undefined!");e.browser=g,e.version=i,e.rule=h,e.match=d(h),e.matched=e.match(i)}}),e},matched:!1,_outOfExpires:function(a){var b=+c.get(j);return!b||!a||+new Date-b>a?1:0},_showToptip:function(a){var b=this,d=b.options;KISSY.use([f+"/toptip.js",d.theme?d.theme:f+"/toptip.less.css"],function(e,f){a.call(b,c,null,(new f).render(d.toptip).show())})},_showDialog:function(a){var b=this,d=b.options;KISSY.use([f+"/dialog.js",d.theme?d.theme:f+"/dialog.less.css"],function(e,f){a.call(b,c,(new f).render(d.dialog).show())})},_showAll:function(a){var b=this,d=b.options,e=[f+"/dialog.js",f+"/toptip.js"];d.theme?e.push(d.theme):(e.push(f+"/dialog.less.css"),e.push(f+"/toptip.less.css")),KISSY.use(e,function(e,f,g){var h=(new g).render(d.toptip);a.call(b,c,(new f).render(d.dialog).show().on("hide",function(){h&&h.show(),c.set(j,+new Date)}),h)})},kill:function(a){var b=this,c=b.options;if(a=a||h,b.matched){if(b._outOfExpires(c.expires)||(b.show="toptip"),"toptip"===b.show)return b._showToptip(a),b;if("dialog"===b.show)return b._showDialog(a),b;b._showAll(a)}return b}},e.VERSION="1.1",e},{requires:["ua","./store.js"]});